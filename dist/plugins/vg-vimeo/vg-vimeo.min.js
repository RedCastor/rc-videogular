!function(e){"use strict";e.module("rc-videogular.plugins.vimeo",[]).directive("vgVimeo",["$window","$timeout","VG_STATES","VG_UTILS","VG_VOLUME_KEY",function(t,n,i,o,r){return{restrict:"A",require:"^videogular",link:function(a,u,l,c){var m,d,s,f=0,p=0,g=!0,v=0,E=e.isDefined(l.vgVimeoFullscreen)?l.vgVimeoFullscreen:"true",y=function(){c.onUpdateTime({target:c.mediaElement[0]})},b=function(){g=!1;var e=new CustomEvent("playing");c.mediaElement[0].dispatchEvent(e),c.setState(i.PLAY)},h=function(){g=!0;var e=new CustomEvent("pause");c.mediaElement[0].dispatchEvent(e),c.setState(i.PAUSE)},w=function(){c.onComplete()},V=function(e){f=e.seconds,p=e.duration,y()},P=function(e){var t=new CustomEvent("waiting");c.mediaElement[0].dispatchEvent(t)};function S(){var e=new CustomEvent("loadedmetadata");c.mediaElement[0].dispatchEvent(e)}function C(u){if(u){var l,C,A,O=(l=u.match(/^.+vimeo.com\/(.*\/)?([^#\?]*)/))?l[2]||l[1]:null;if(O)C=O,m?A=m.element:(A=document.createElement("iframe"),e.element(c.mediaElement[0]).replaceWith(e.element(A))),A.src="//player.vimeo.com/video/"+C+"?player_id=vimeoplayer",A.frameBorder=0,A.scrolling="no",A.style.width="100%",A.style.height="100%",a.$eval(E)&&(A.setAttribute("webkitallowfullscreen",""),A.setAttribute("mozallowfullscreen",""),A.setAttribute("allowfullscreen","")),e.element(A.parentNode.parentNode).find("vg-overlay-play").css("height","calc(100% - 50px)"),(m=new Vimeo.Player(A)).ready().then(function(){!function(){if(Object.defineProperty(c.mediaElement[0],"currentTime",{get:function(){return f},set:function(e){f=e,m.setCurrentTime(f)},enumerable:!0,configurable:!0}),Object.defineProperty(c.mediaElement[0],"duration",{get:function(){return p},enumerable:!0,configurable:!0}),Object.defineProperty(c.mediaElement[0],"paused",{get:function(){return g},enumerable:!0,configurable:!0}),Object.defineProperty(c.mediaElement[0],"videoWidth",{get:function(){return d},enumerable:!0,configurable:!0}),Object.defineProperty(c.mediaElement[0],"videoHeight",{get:function(){return s},enumerable:!0,configurable:!0}),Object.defineProperty(c.mediaElement[0],"volume",{get:function(){return v},set:function(e){v=e,m.setVolume(v)},enumerable:!0,configurable:!0}),c.mediaElement[0].play=function(){m.play()},c.mediaElement[0].pause=function(){m.pause()},m.getVolume().then(function(e){v=e,c.onVolumeChange()}),m.getCurrentTime().then(function(e){f=e,S()}),m.getDuration().then(function(e){p=e,S()}),y(),o.supportsLocalStorage()&&c.setVolume(parseFloat(t.localStorage.getItem(r)||"1")),c.currentState!==i.PLAY){var e=new CustomEvent("canplay");c.mediaElement[0].dispatchEvent(e),!0===c.autoPlay&&n(function(){c.play()})}else m.play().then(function(){})}()}),m.on("play",b),m.on("pause",h),m.on("ended",w),m.on("timeupdate",V),m.on("progress",P)}else m&&m.destroy()}a.$watch(function(){return c.sources},function(e,t){e&&e.length>0&&e[0].src?C(e[0].src.toString()):C(null)})}}}])}(angular);